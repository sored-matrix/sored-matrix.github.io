<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SORED - System Oceny Rozwoju Edukacji Dostępnej. Kompleksowe narzędzie do oceny dziewięciu wymiarów dostępności w edukacji.">
    <title>SORED - System Oceny Rozwoju Edukacji Dostępnej</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>
    <!-- Skip to main content link for keyboard users -->
    <a href="#main-content" class="skip-link">Przejdź do głównej treści</a>
    
    <!-- Accessibility Controls -->
    <div class="accessibility-toolbar">
        <button id="definitions-toggle" class="accessibility-btn" aria-label="Pokaż definicje" title="Definicje" data-bs-toggle="modal" data-bs-target="#definitionsModal">
            <i class="bi bi-journal-text" aria-hidden="true"></i>
            <span class="btn-text">Definicje</span>
        </button>
        <button id="font-size-toggle" class="accessibility-btn" aria-label="Zwiększ rozmiar czcionki" title="Rozmiar czcionki">
            <i class="bi bi-type" aria-hidden="true"></i>
            <span class="btn-text">A+</span>
        </button>
        <button id="contrast-toggle" class="accessibility-btn contrast-btn" aria-label="Przełącz tryb wysokiego kontrastu" title="Wysoki kontrast">
            <i class="bi bi-circle-half" aria-hidden="true"></i>
            <span class="btn-text">Wysoki kontrast</span>
        </button>
    </div>
    
    <!-- Header -->
    <header class="hero-section" role="banner">
        <a href="https://ibe.edu.pl/pl/", target="_blank">
        <img id="hero-logo" src="static/logo_white.svg" alt="Logo" class="hero-logo">
    </a>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10 text-center">
                    <h1 class="display-3 fw-bold mb-3">
                        <span class="logo-text">
                            <span class="letter">S</span><i class="bi bi-universal-access-circle logo-icon-letter" aria-hidden="true"></i><span class="letter">R</span><span class="letter">E</span><span class="letter">D</span>
                        </span>
                    </h1>
                    <p class="lead fs-4">System Oceny Rozwoju Edukacji Dostępnej</p>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="py-5" role="main">
        <div class="container">
            <div class="row justify-content-center mb-5">
                <div class="col-lg-10 text-center">
                    <h2 class="section-title mb-4">Wymiary Dostępności</h2>
                    <p class="text-muted">Kompleksowe podejście do oceny edukacji dostępnej</p>
                </div>
            </div>

            <div class="row g-4" role="list" aria-label="Wymiary dostępności edukacji">
                <!-- Osiągnięcia Edukacyjne -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="osiagniecia" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-mortarboard-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">OSIĄGNIĘCIA EDUKACYJNE</h3>
                            <p class="card-text text-muted">wynikające z realizacji edukacji dostępnej</p>
                        </div>
                    </article>
                </div>

                <!-- Uczestnictwo -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="uczestnictwo" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-people-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">UCZESTNICTWO</h3>
                            <p class="card-text text-muted">umożliwiające pełen rozwój</p>
                        </div>
                    </article>
                </div>

                <!-- Dydaktyka -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="dydaktyka" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-book-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">DYDAKTYKA</h3>
                            <p class="card-text text-muted">zapewniająca dostępność procesu edukacyjnego</p>
                        </div>
                    </article>
                </div>

                <!-- Kadry -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="kadry" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-person-badge-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">KADRY</h3>
                            <p class="card-text text-muted">realizujące edukację dostępną</p>
                        </div>
                    </article>
                </div>

                <!-- Zasoby -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="zasoby" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-box-seam-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">ZASOBY</h3>
                            <p class="card-text text-muted">umożliwiające dostępność</p>
                        </div>
                    </article>
                </div>

                <!-- Organizacja -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="organizacja" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-diagram-3-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">ORGANIZACJA</h3>
                            <p class="card-text text-muted">sprzyjająca dostępności</p>
                        </div>
                    </article>
                </div>

                <!-- Architektura -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="architektura" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-building-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">ARCHITEKTURA</h3>
                            <p class="card-text text-muted">zapewniająca dostępność</p>
                        </div>
                    </article>
                </div>

                <!-- Cyfrowa -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="cyfrowa" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-laptop-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">CYFROWA</h3>
                            <p class="card-text text-muted">dostępność usług</p>
                        </div>
                    </article>
                </div>

                <!-- Komunikacja -->
                <div class="col-md-6 col-lg-4" role="listitem">
                    <article class="card dimension-card h-100" data-dimension="komunikacja" tabindex="0">
                        <div class="card-body text-center">
                            <div class="icon-wrapper mb-3" aria-hidden="true">
                                <i class="bi bi-chat-dots-fill"></i>
                            </div>
                            <h3 class="card-title h5 fw-bold">KOMUNIKACJA</h3>
                            <p class="card-text text-muted">bez barier</p>
                        </div>
                    </article>
                </div>
            </div>
        </div>
        
        <!-- Indicators Section -->
        <section id="indicators-section" class="indicators-section py-5">
            <div class="container">
                <h2 class="text-center mb-5">Wskaźniki</h2>
                
                <!-- Placeholder for dynamic indicator content -->
                <div id="indicator-content" class="indicator-content">
                    <p class="text-center text-muted">Wybierz wymiar dostępności, aby zobaczyć wskaźniki</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Definitions Modal -->
    <div class="modal fade" id="definitionsModal" tabindex="-1" aria-labelledby="definitionsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="definitionsModalLabel">
                        <i class="bi bi-journal-text me-2"></i>Definicje Wskaźników
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Zamknij"></button>
                </div>
                <div class="modal-body" id="definitionsModalBody">
                    <div class="definitions-list">
                        <!-- Definitions will be loaded here -->
                        <p class="text-center text-muted">Ładowanie definicji...</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Zamknij</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer mt-5 py-4" role="contentinfo">
        <div class="container text-center">
            <p class="mb-0 text-muted">SORED - System Oceny Rozwoju Edukacji Dostępnej</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Accessibility Controls Script -->
    <script>
        // Font Size Toggle
        const fontSizeToggle = document.getElementById('font-size-toggle');
        const contrastToggle = document.getElementById('contrast-toggle');
        const body = document.body;
        
        // Font size states: normal, medium, large
        const fontSizes = ['normal', 'medium', 'large'];
        let currentFontSizeIndex = 0;
        
        // Load saved font size preference
        const savedFontSize = localStorage.getItem('fontSize');
        if (savedFontSize) {
            currentFontSizeIndex = fontSizes.indexOf(savedFontSize);
            if (currentFontSizeIndex === -1) currentFontSizeIndex = 0;
            body.classList.add('font-size-' + fontSizes[currentFontSizeIndex]);
            updateFontSizeButton();
        }
        
        // Function to update font size button text
        function updateFontSizeButton() {
            const btn = fontSizeToggle.querySelector('.btn-text');
            if (currentFontSizeIndex === 0) {
                btn.textContent = 'A+';
            } else if (currentFontSizeIndex === 1) {
                btn.textContent = 'A++';
            } else {
                btn.textContent = 'A+++';
            }
        }
        
        // Toggle font size
        fontSizeToggle.addEventListener('click', function() {
            // Remove current font size class
            body.classList.remove('font-size-' + fontSizes[currentFontSizeIndex]);
            
            // Move to next size (cycle through)
            currentFontSizeIndex = (currentFontSizeIndex + 1) % fontSizes.length;
            
            // Add new font size class
            body.classList.add('font-size-' + fontSizes[currentFontSizeIndex]);
            
            // Update button
            updateFontSizeButton();
            
            // Save preference
            localStorage.setItem('fontSize', fontSizes[currentFontSizeIndex]);
            
            // Announce change to screen readers
            const announcement = document.createElement('div');
            announcement.setAttribute('role', 'status');
            announcement.setAttribute('aria-live', 'polite');
            announcement.className = 'sr-only';
            announcement.textContent = 'Rozmiar czcionki: ' + 
                (currentFontSizeIndex === 0 ? 'normalny' : 
                 currentFontSizeIndex === 1 ? 'średni' : 'duży');
            body.appendChild(announcement);
            setTimeout(() => announcement.remove(), 1000);
        });
        
        // High Contrast Toggle
        
        // Check for system preference for high contrast
        const prefersHighContrast = window.matchMedia('(prefers-contrast: high)').matches;
        
        // Check for saved preference
        const savedContrast = localStorage.getItem('highContrast');
        
        // Apply high contrast if either system prefers it or user saved preference
        if (savedContrast === 'true' || (savedContrast === null && prefersHighContrast)) {
            body.classList.add('high-contrast');
            contrastToggle.setAttribute('aria-pressed', 'true');
        } else {
            contrastToggle.setAttribute('aria-pressed', 'false');
        }
        
        // Listen for system preference changes
        window.matchMedia('(prefers-contrast: high)').addEventListener('change', (e) => {
            // Only auto-switch if user hasn't set a manual preference
            if (localStorage.getItem('highContrast') === null) {
                if (e.matches) {
                    body.classList.add('high-contrast');
                    contrastToggle.setAttribute('aria-pressed', 'true');
                } else {
                    body.classList.remove('high-contrast');
                    contrastToggle.setAttribute('aria-pressed', 'false');
                }
            }
        });
        
        // Toggle high contrast mode
        contrastToggle.addEventListener('click', function() {
            body.classList.toggle('high-contrast');
            const isHighContrast = body.classList.contains('high-contrast');
            
            // Save preference
            localStorage.setItem('highContrast', isHighContrast);
            
            // Update ARIA state
            contrastToggle.setAttribute('aria-pressed', isHighContrast);
            
            // Announce change to screen readers
            const announcement = document.createElement('div');
            announcement.setAttribute('role', 'status');
            announcement.setAttribute('aria-live', 'polite');
            announcement.className = 'sr-only';
            announcement.textContent = isHighContrast ? 
                'Tryb wysokiego kontrastu włączony' : 
                'Tryb wysokiego kontrastu wyłączony';
            body.appendChild(announcement);
            setTimeout(() => announcement.remove(), 1000);
        });
        
        // Card Click Handlers for Indicators
        const dimensionCards = document.querySelectorAll('.dimension-card');
        const indicatorSection = document.getElementById('indicators-section');
        const indicatorContent = document.getElementById('indicator-content');
        
        // Load indicator data from JSON file
        let indicatorData = {};
        let definitionsData = {};
        let dataLoaded = false;
        
        // Fetch indicators from JSON
        fetch('static/indicators_for_website.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                indicatorData = data;
                console.log('Indicators loaded successfully', Object.keys(data));
                
                // Also fetch definitions
                return fetch('static/indicator_definitions.json');
            })
            .then(response => response.json())
            .then(data => {
                definitionsData = data;
                dataLoaded = true;
                console.log('Definitions loaded successfully', Object.keys(data).length, 'definitions');
            })
            .catch(error => {
                console.error('Error loading data:', error);
                dataLoaded = true;
                // Fallback to empty data if file not found
                indicatorData = {};
                definitionsData = {};
            });
        
        // Function to display indicators
        function showIndicators(dimension) {
            if (!dataLoaded) {
                console.log('Data not loaded yet, waiting...');
                setTimeout(() => showIndicators(dimension), 100);
                return;
            }
            
            const data = indicatorData[dimension];
            if (!data || !data.indicators || data.indicators.length === 0) {
                console.log('No data found for dimension:', dimension);
                indicatorContent.innerHTML = '<p class="text-center text-muted">Brak wskaźników dla tego wymiaru</p>';
                return;
            }
            
            // Build HTML for indicators
            let html = `
                <h3 class="mb-4 text-center">${data.title}</h3>
                <div class="row">
            `;
            
            data.indicators.forEach((indicator, index) => {
                // Remove leading numbers (e.g., "1. ", "2. ")
                let cleanedIndicator = indicator.replace(/^\d+\.\s*/, '');
                
                // Capitalize first letter
                cleanedIndicator = cleanedIndicator.charAt(0).toUpperCase() + cleanedIndicator.slice(1);
                
                // Preserve line breaks by converting \n to <br>
                const formattedIndicator = cleanedIndicator.replace(/\n/g, '<br>');
                
                html += `
                    <div class="col-md-4 mb-3">
                        <div class="indicator-item">
                            <i class="bi bi-check-circle-fill indicator-icon"></i>
                            <p>${formattedIndicator}</p>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            indicatorContent.innerHTML = html;
            
            console.log('Indicators displayed, scrolling to section...');
            
            // Smooth scroll to indicators section (respecting reduced motion preference)
            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
            setTimeout(() => {
                indicatorSection.scrollIntoView({ 
                    behavior: prefersReducedMotion ? 'auto' : 'smooth', 
                    block: 'start' 
                });
            }, 100);
        }
        
        // Add click event listeners to all dimension cards
        dimensionCards.forEach(card => {
            card.addEventListener('click', function() {
                const dimension = this.getAttribute('data-dimension');
                console.log('Card clicked, dimension:', dimension);
                showIndicators(dimension);
                
                // Add active state to clicked card
                dimensionCards.forEach(c => c.classList.remove('active'));
                this.classList.add('active');
            });
            
            // Add keyboard support
            card.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    this.click();
                }
            });
        });
        
        console.log('Card click handlers attached to', dimensionCards.length, 'cards');
        
        // Full dimension titles with subtitles
        const dimensionFullTitles = {
            'osiagniecia': 'OSIĄGNIĘCIA EDUKACYJNE wynikające z realizacji edukacji dostępnej',
            'uczestnictwo': 'UCZESTNICTWO umożliwiające pełen rozwój',
            'dydaktyka': 'DYDAKTYKA zapewniająca dostępność procesu edukacyjnego',
            'kadry': 'KADRY realizujące edukację dostępną',
            'zasoby': 'ZASOBY umożliwiające dostępność',
            'organizacja': 'ORGANIZACJA sprzyjająca dostępności',
            'architektura': 'ARCHITEKTURA zapewniająca dostępność',
            'cyfrowa': 'CYFROWA dostępność usług',
            'komunikacja': 'KOMUNIKACJA bez barier'
        };
        
        // Load definitions when modal is shown
        const definitionsModal = document.getElementById('definitionsModal');
        definitionsModal.addEventListener('show.bs.modal', function () {
            const modalBody = document.querySelector('#definitionsModalBody .definitions-list');
            
            if (!dataLoaded) {
                modalBody.innerHTML = '<p class="text-center text-muted">Ładowanie definicji...</p>';
                return;
            }
            
            if (Object.keys(definitionsData).length === 0 || Object.keys(indicatorData).length === 0) {
                modalBody.innerHTML = '<p class="text-center text-muted">Brak dostępnych definicji</p>';
                return;
            }
            
            // Build HTML grouped by dimensions
            let html = '';
            let globalCount = 0;
            
            // Iterate through dimensions
            for (const [dimension, data] of Object.entries(indicatorData)) {
                const dimensionIndicators = data.indicators || [];
                
                // Find indicators that have definitions
                const indicatorsWithDefinitions = dimensionIndicators.filter(ind => definitionsData[ind]);
                
                if (indicatorsWithDefinitions.length === 0) {
                    continue; // Skip dimensions with no definitions
                }
                
                // Get full dimension title with subtitle
                const fullTitle = dimensionFullTitles[dimension] || data.title;
                
                // Add dimension header
                html += `<div class="dimension-group">
                            <h5 class="dimension-header">${fullTitle}</h5>`;
                
                // Add definitions for this dimension (without indicator names)
                indicatorsWithDefinitions.forEach(indicator => {
                    globalCount++;
                    const definition = definitionsData[indicator];
                    
                    html += `
                        <div class="definition-item">
                            <div class="definition-number">${globalCount}</div>
                            <div class="definition-content">
                                <p class="definition-text">${definition}</p>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div>'; // Close dimension-group
            }
            
            if (html === '') {
                modalBody.innerHTML = '<p class="text-center text-muted">Brak dostępnych definicji</p>';
            } else {
                modalBody.innerHTML = html;
            }
        });
    </script>
</body>
</html>

